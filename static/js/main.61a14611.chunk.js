(this.webpackJsonptemplate_react=this.webpackJsonptemplate_react||[]).push([[0],{79:function(t,e,n){},80:function(t,e,n){},83:function(t,e,n){},92:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),s=n(41),c=n.n(s),o=(n(79),n(80),n(6)),u=n(4),i=n.n(u),l=n(13),p=n(7),d=n(8),j=n(51),f=n(49),h=n(117),b=n(119),v=n(114),O=n(67),x=n.n(O),g=n(68),S=n.n(g),m=n(69),k=n.n(m),y=n(118),w=n(47),C=function(){function t(){Object(p.a)(this,t)}return Object(d.a)(t,null,[{key:"toRadians",value:function(t){return t*Math.PI/180}},{key:"getDistance",value:function(e,n){var r=Object(o.a)(e,2),a=r[0],s=r[1],c=Object(o.a)(n,2),u=c[0],i=c[1],l=[t.toRadians(u-a),t.toRadians(i-s)],p=l[0],d=l[1],j=[t.toRadians(a),t.toRadians(u)],f=j[0],h=j[1],b=Math.sin(p/2)*Math.sin(p/2)+Math.sin(d/2)*Math.sin(d/2)*Math.cos(f)*Math.cos(h);return 6371*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)))}}]),t}(),M=function(){function t(){Object(p.a)(this,t)}return Object(d.a)(t,null,[{key:"getStopsIndex",value:function(){var t=Object(l.a)(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/bus_lk_app/data/stops.json",t.next=3,w.a.json("/bus_lk_app/data/stops.json");case 3:return e=t.sent,t.abrupt("return",e);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"getClosestStops",value:function(){var e=Object(l.a)(i.a.mark((function e(n){var r,a,s,c,u,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=function(t){var e=Object(o.a)(t,2),n=e[0],r=e[1];return C.getDistance([a,s],[n,r])},r=Object(o.a)(n,2),a=r[0],s=r[1],e.next=4,t.getStopsIndex();case 4:return c=e.sent,l=Object.values(c).map((function(t){return t.distance=u(t.lat_lng),t})),e.abrupt("return",l.sort((function(t,e){return t.distance-e.distance})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),t}(),D=["100-S","103-S","120-S","125-S","135-S","138-S","140-S","154-S","155-S","163-S","166-S","168-S","176-S","177-W","193-S"],I=function(){function t(){Object(p.a)(this,t)}return Object(d.a)(t,null,[{key:"getRouteStopIDs",value:function(){var t=Object(l.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(D.map(function(){var t=Object(l.a)(i.a.mark((function t(e){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="/bus_lk_app/data/routes/".concat(e,".json"),t.next=3,w.a.json(n);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"getRoutesIndex",value:function(){var e=Object(l.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getRouteStopIDs();case 2:return n=e.sent,e.abrupt("return",D.reduce((function(t,e,r){return t[e]=n[r],t}),{}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getRoutesForStops",value:function(){var e=Object(l.a)(i.a.mark((function e(n){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getRoutesIndex();case 2:return r=e.sent,a=new Set,e.abrupt("return",n.reduce((function(t,e){for(var n=e.stop_id,s=0,c=Object.entries(r);s<c.length;s++){var u=Object(o.a)(c[s],2),i=u[0],l=u[1];a.has(i)||l.includes(n)&&(t.push({routeID:i,distance:e.distance}),a.add(i))}return t}),[]));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),t}(),F=n(2);function P(t){var e=t.distanceKM;if(e<1){var n=1e3*e;return Object(F.jsxs)("span",{children:[n.toFixed(0),"m"]})}return e<10?Object(F.jsxs)("span",{children:[e.toFixed(1),"km"]}):Object(F.jsxs)("span",{children:[e.toFixed(0),"km"]})}function R(t){var e=t.closestStops;return Object(F.jsx)("ul",{children:e.map((function(t,e){return Object(F.jsxs)("li",{children:[t.name," (",Object(F.jsx)(P,{distanceKM:t.distance}),")"]},"stop-".concat(e))}))})}function _(t){var e=t.routes;return Object(F.jsx)("ul",{children:e.map((function(t,e){return Object(F.jsxs)("li",{children:[t.routeID," (",Object(F.jsx)(P,{distanceKM:t.distance}),")"]},"route-".concat(e))}))})}var L=n(109),B=n(120),z=n(121),V={centerCircle:{color:"red",stroke:null,fillOpacity:.25,radius:100},stopCircle:{color:"blue",fillOpacity:.5,stroke:null,radius:10}},K=(n(83),function(t){Object(j.a)(n,t);var e=Object(f.a)(n);function n(){return Object(p.a)(this,n),e.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var t=this.props,e=t.center,n=t.zoom;return Object(F.jsxs)(L.a,{center:e,zoom:n,zoomControl:!1,children:[Object(F.jsx)(B.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.props.children,Object(F.jsx)(z.a,{center:e,radius:V.centerCircle.radius,pathOptions:V.centerCircle})]})}}]),n}(r.Component));function N(t){var e=t.stop;return Object(F.jsx)(z.a,{center:e.lat_lng,radius:V.stopCircle.radius,pathOptions:V.stopCircle})}var q=0,G=1,J=2,T=function(t){Object(j.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(p.a)(this,n),(r=e.call(this,t)).state={latLng:void 0,closestStops:void 0,isDataLoaded:!1,navigationPaneValue:q},r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=Object(l.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:navigator.geolocation.getCurrentPosition(this.onGetCurrentPosition.bind(this));case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"onGetCurrentPosition",value:function(){var t=Object(l.a)(i.a.mark((function t(e){var n,r,a,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[e.coords.latitude,e.coords.longitude],t.next=3,M.getClosestStops(n);case 3:return r=t.sent,a=r.slice(0,10),t.next=7,I.getRoutesForStops(a);case 7:s=t.sent,this.setState({latLng:n,closestStops:r,closestStopsDisplay:a,routesForStops:s,isDataLoaded:!0});case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"onChangeBottomNavigation",value:function(t,e){this.setState({navigationPaneValue:e})}},{key:"renderMap",value:function(){var t=this.state,e=t.latLng,n=t.closestStops,r=Object(o.a)(e,2),a=r[0],s=r[1];return Object(F.jsx)(K,{center:[a,s],zoom:18,className:"geo-map",children:n.map((function(t,e){return Object(F.jsx)(N,{stop:t},"stop-circle-".concat(e))}))})}},{key:"renderBusses",value:function(){var t=this.state.routesForStops;return Object(F.jsx)(_,{routes:t})}},{key:"renderStops",value:function(){var t=this.state.closestStopsDisplay;return Object(F.jsx)(R,{closestStops:t})}},{key:"renderInner",value:function(){switch(this.state.navigationPaneValue){case q:return this.renderMap();case G:return this.renderBusses();case J:return this.renderStops();default:return null}}},{key:"render",value:function(){var t=this.state,e=t.isDataLoaded,n=t.navigationPaneValue;return e?Object(F.jsxs)(h.a,{children:[this.renderInner(),Object(F.jsx)(y.a,{sx:{position:"fixed",bottom:0,left:0,right:0},elevation:3,children:Object(F.jsxs)(b.a,{showLabels:!0,onChange:this.onChangeBottomNavigation.bind(this),value:n,children:[Object(F.jsx)(v.a,{label:"Map",icon:Object(F.jsx)(x.a,{})}),Object(F.jsx)(v.a,{label:"Busses",icon:Object(F.jsx)(S.a,{})}),Object(F.jsx)(v.a,{label:"Stops",icon:Object(F.jsx)(k.a,{})})]})})]}):"Loading..."}}]),n}(r.Component);var E=function(){return Object(F.jsx)(T,{})},W=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,122)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,s=e.getLCP,c=e.getTTFB;n(t),r(t),a(t),s(t),c(t)}))};c.a.render(Object(F.jsx)(a.a.StrictMode,{children:Object(F.jsx)(E,{})}),document.getElementById("root")),W()}},[[92,1,2]]]);
//# sourceMappingURL=main.61a14611.chunk.js.map